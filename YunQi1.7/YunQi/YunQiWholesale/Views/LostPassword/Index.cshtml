@{
    Layout = null;
}

<!DOCTYPE html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="initial-scale=1 user-scalable=no" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>@ViewData["Title"] - YunQiWholesale</title>
    <link rel="apple-touch-icon" sizes="180x180" href="~/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="~/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="~/favicon/favicon-16x16.png">
    <link rel="mask-icon" href="~/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="~/lib/fontawesome-free/css/all.css" />
    <link rel="stylesheet" href="~/lib/swiper/css/swiper.css" />
    <link rel="stylesheet" href="~/css/main.css" />
</head>
<body>

    <div class="container" style="margin-top: 15%;">
        <div class="row justify-content-center align-items-center">
            <div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8">
                <section class="login-form">
                    <div class="form-group row">
                        <label for="" class="control-label col-12 col-sm-12 col-md-12 col-lg-3 col-xl-3">帳號：</label>
                        <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6">
                            <input id="MemberMobile" type="text" class="form-control" readonly />
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="" class="control-label col-12 col-sm-12 col-md-12 col-lg-3 col-xl-3">密碼：</label>
                        <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6">
                            <input id="MemberPassword" type="text" class="form-control" value="123" />
                        </div>
                    </div>

                    <div class="form-group row">
                        <label for="" class="control-label col-12 col-sm-12 col-md-12 col-lg-3 col-xl-3">再次輸入密碼：</label>
                        <div class="col-12 col-sm-12 col-md-12 col-lg-6 col-xl-6">
                            <input id="DoubleCheckPassword" type="password" class="form-control" value="123" />
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-md-offset-2 col-md-10">
                            @*<recaptcha />*@
                            <span class="text-danger" id="recaptchaErrorMessage"></span>
                        </div>
                    </div>
                    <div class="row">
                        <div class="function-box col-md-4 ml-md-auto"></div>
                        <div class="function-box col-md-3 ml-md-auto">
                            <button type="button" class="btn btn-success" onclick="javascript:window.location='@Url.Action("Index", "Home")'">取消</button>
                        </div>
                        <div class="function-box col-md-3 ml-md-auto">
                            <button type="button" class="btn btn-success" id="ChangePassword">確定變更</button>
                        </div>
                        <div class="function-box col-md-2 ml-md-auto"></div>
                    </div>
                </section>
            </div>
        </div>
    </div>
</body>

@*以下參考*@
<script src="~/lib/jquery/dist/jquery.js"></script>
@*<script src="~/lib/jquery.form.min.js" asp-append-version="true"></script>*@
<script src="~/js/DatatimeSetting.js" asp-append-version="true"></script>
<link href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/themes/hot-sneaks/jquery-ui.css" rel="stylesheet">
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.js"></script>
<link rel="stylesheet" href="~/css/jquery-ui-timepicker-addon.min.css" />
<script src="~/js/jquery-ui-timepicker-addon.js" asp-append-version="true"></script>
<script src="~/js/jquery-ui-sliderAccess.js" asp-append-version="true"></script>
<script src="~/lib/popper.js/dist/umd/popper.min.js"></script>
<script src="~/lib/bootstrap/dist/js/bootstrap.js"></script>
<script src="~/lib/swiper/js/swiper.js"></script>
<script src="~/js/ObjectModel.js"></script>
<script src="~/js/RegularExpression.js"></script>
<script src="~/js/homepage.js"></script>
@*<script src="~/js/LostPasswordController.js"></script>*@
<script>
    // 6-2.系統將5以ViewBag回傳之MemberId與UpMemberId暫存在Client端之Javascript變數jMemberId與jUpMemberId。
    $(function () {
        jMemberlevelId = parseInt('@ViewBag.MemberLevelId');
        jMemberMobile = '@ViewBag.MemberMobile';
        jNickName = '@ViewBag.NickName';
        Homepagefunction(
            '@Url.Action("Index", "Mall")',
            '@Url.Action("Index", "Cart")',
            '@Url.Action("Login", "Home")',
            '@Url.Action("main", "Home")',
            '@Url.Action("Index", "Member")',
            '@Url.Action("Index", "Joinus")',
            '@Url.Action("Personaldata", "Member")',
            '@Url.Action("Memberlevel", "Member")',
            '@Url.Action("Wholesaletips", "Member")',
            '@Url.Action("Shipaddress", "Member")',
            '@Url.Action("Myorder", "Member")',
            '@Url.Action("Myfavorite", "Member")',
            '@Url.Action("Myfollower", "Member")',
            '@Url.Action("Followertriumph", "Member")',
            '@Url.Action("Pointnotes", "Member")',
            '@Url.Action("Wishipool", "Member")',
            '@Url.Action("Membermove", "Member")',
            '@Url.Action("Mailcenter", "Member")',
            '@Url.Action("Register", "Joinus")',
            '@Url.Action("shoppingflow", "Joinus")',
            '@Url.Action("Payway", "Joinus")',
            '@Url.Action("Qanda", "Joinus")',
            '@Url.Action("Shipdays", "Joinus")',
            '@Url.Action("Success", "Cart")',
            '@Url.Action("GetProductList", "Mall")',
            '@Url.Action("GetProductLevelPath", "Mall")',
            '@Url.Action("GetProductCategoryId", "Mall")',
            '@Url.Action("GetProductDetail", "Mall")',
            '@Url.Action("GetOfferProductList", "Mall")',
            '@Url.Action("JoinMember", "Joinus")',
            '@Url.Action("Login", "Home")',
            '@Url.Action("PutMember", "Member")',
            '@Url.Action("PutMemberLevel", "Member")',
            '@Url.Action("PostMemberFavorite", "Member")',
            '@Url.Action("GetProductStock", "Mall")',
            '@Url.Action("PostMemberCarts", "Mall")',
            '@Url.Action("FavoriteDetail", "Member")',
            '@Url.Action("DeleteCart", "Cart")',
            '@Url.Action("DeleteCarts", "Cart")',
            '@Url.Action("UpdateCart", "Cart")',
            '@Url.Action("GetFreight", "Cart")',
            '@Url.Action("GetOutFreight", "Cart")',
            '@Url.Action("PostOrder", "Cart")',
            '@Url.Action("UpdateOrderState3", "Member")',
            '@Url.Action("DeleteMyfavorite", "Member")',
            '@Url.Action("Logout", "Home")',
            '@Url.Action("Index", "Home")',
            '@Url.Action("InsertMemberForget", "LostPassword")',
            '@Url.Action("UpdateMemberPassword", "LostPassword")', 
        );
        //window.onload = "LostPasswordController()";
    });

    $(document).ready(function () {
        var url = location.href;
        //再來用去尋找網址列中是否有資料傳遞(QueryString)
        if (url.indexOf('?') != -1) {
            var ary = url.split('?')[1].split('&');
            //下迴圈去搜尋每個資料參數
            for (i = 0; i <= ary.length - 1; i++) {
                if (ary[i].split('=')[0] == 'MemberMobile')
                    sMemberMobile = ary[i].split('=')[1];
            }
            for (i = 0; i <= ary.length - 1; i++) {
                if (ary[i].split('=')[0] == 'token')
                    sToken = ary[i].split('=')[1];
            }
            console.log(sMemberMobile);
            console.log(sToken);
        }

        $('#MemberMobile').val(sMemberMobile);
        $('#MemberPassword').val("");
        $('#DoubleCheckPassword').val("");

        $.ajax({
            type: 'POST',
            cache: false,
            dataType: 'Json',
            url: "LostPassword/MemberForget",
            data: {
                MemberMobile: sMemberMobile,
                token: sToken,
            }
        })
            .done(success)
            .fail(systemError)

        function success(data) {
            if (data == -1) {
                alert("帳號錯誤 ! ");
                javascript: window.location = "/Home/Index";
            } else if (data == -3) {
                alert("超過20分鐘，請重新申請 ! ");
                javascript: window.location = "/Home/Index";
            } else if (data == -4) {
                alert("查無此資料，請重新申請 ! ");
                javascript: window.location = "/Home/Index";
            } else if (data == -5) {
                alert("密碼已修改，請重新申請 ! ");
                javascript: window.location = "/Home/Index";
            } else { };
        };
    });
</script>
<script language="javascript" type="text/javascript">
    $(document).on("keydown", function (e) {
        if (e.key == "F5" || e.key == "F11" ||
            (e.ctrlKey == true && (e.key == 'r' || e.key == 'R')) ||
            e.keyCode == 116 || e.keyCode == 82) {
            e.preventDefault();
        }
    });
    window.addEventListener('beforeunload', function (e) {
        // Cancel the event
        e.preventDefault();
        // Chrome requires returnValue to be set
        e.returnValue = '';
    });
</script>
