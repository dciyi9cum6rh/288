function Homepagefunction(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt,yt,pt,wt,bt,kt,dt,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ai,vi,yi){function yr(n){n==0?(alert("刪除成功"),$selecteditadmin.remove()):n==2?alert("無此項商品！"):alert("刪除失敗，請稍後再試！")}const ur=$(window).innerHeight();let fr;$(document).on("click","#ulHome li a",function(n){n.preventDefault();$(".spaDiv").hide();$(`#${$(this).data("spadiv")}`).show()});$(document).on("click","#btnExpanProductCategory",n=>{n.preventDefault(),$("#divXsProductCategory").html($("#productsidenavcontent").html()),$("#mainContent").hide(),$("#divXsProductCategory").show()});$(document).on("click","#btnProductCategoryClose",n=>{n.preventDefault(),$("#divXsProductCategory").hide(),$("#mainContent").show()});$(document).on("click","#btnCloseproductDetailView",n=>{n.preventDefault(),$("#productDetailPage").fadeOut(),$("#productPage").fadeIn(),window.scrollTo(0,0)});$(document).on("click","#productView div div div a",n=>{n.preventDefault(),$("#productPage").fadeOut(),$("#productDetailPage").fadeIn(),window.scrollTo(0,0)});const pi=()=>{alert("系統錯誤，請稍後再試！")},pr=()=>{},sr=n=>{$("#mainContent").empty(),$("#mainContent").html(n),$(".header-box").find(".navbar-toggler").addClass("collapsed"),$("#menuNavbar").removeClass("show"),carts=[]},er=n=>{$("#mainContent").empty();$("#mainContent").html(n);fr=new Swiper(".swiper-container",{autoHeight:!0,slidesPerView:3,centeredSlides:!0,spaceBetween:30,loop:!0,autoplay:{delay:2500,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});$("#linkJoinUs").on("click",()=>{$.ajax({type:"GET",cache:!1,dataType:"HTML",url:f}).done(gi).fail(pi),$("#navMenu").find(".nav-link").removeClass("active"),$("#navMenu").find('.nav-link[data-nav="joinus"]').addClass("active")})},or=n=>{$("#mainContent").empty();$("#mainContent").html(n);jMemberlevelId!==2?($("#btnOfferProduct").hide(),$("#btnAllProduct").hide()):($("#btnOfferProduct").show(),$("#btnAllProduct").show());const t=$(".productlist-item .product-pic").width();$(".productlist-item .product-pic").height(t);$(document).on("click","#mobileSide",()=>{$(".alltype-box").addClass("active")});$("#btnAlltypeClose").on("click",()=>{$(".alltype-box").removeClass("active")});$(document).on("click",".productlist-item .product-pic, .productlist-item .btn-AddToCart, .btn-favoritedetail",n=>{if(jMemberMobile===null||jMemberMobile===""){alert("請先登入！");return}jProductId=$(n.currentTarget).data("productid");$.ajax({type:"POST",cache:!1,dataType:"HTML",url:et,data:{ProductId:$(n.currentTarget).data("productid"),MemberLevelId:jMemberlevelId}}).done(hr).fail(pi)})};$(document).on("click","#btnProductDetailClose",n=>{n.preventDefault(),$("#productDetail").removeClass("active")});const hr=n=>{$("#productDetail").addClass("active"),$("#productDetail").html(n)},wr=n=>{$("#mainContent").empty(),$("#mainContent").html(n)},tr=t=>{$("#mainContent").empty();$("#mainContent").html(t);$("#cartlistPanel").find(".btn-back").on("click",()=>{$("#navMenu").find(".nav-link").removeClass("active"),$("#navMenu").find('.nav-link[data="nav"]').addClass("active"),$.ajax({type:"GET",cache:!1,dataType:"HTML",data:{MemberLevelId:jMemberlevelId},url:n}).done(or).fail(pi)});$("#cartlistPanel").find(".btn-next").on("click",()=>{$("#CartLists tr").length>0?(jMemberMobile!=""&&(carts=[],$("#CartLists input:checkbox").each(function(n,t){carts.push(new cart($(t).data("productid"),$(t).data("producsizeid"),$(t).data("productcolorid"),$(t).data("quantity"),$(t).data("product"),$(t).data("price")))}),console.log(carts)),cartTobal=$("#cartTotals").text(),$(".flowpath-item").removeClass("active"),$("#personalFlow").addClass("active"),$("#cartlistPanel").removeClass("active"),$("#personalPanel").addClass("active"),window.scrollTo(0,0)):alert("無任何購物項目！")});$("#personalPanel").find(".btn-back").on("click",()=>{$(".flowpath-item").removeClass("active"),$("#cartlistFlow").addClass("active"),$("#personalPanel").removeClass("active"),$("#cartlistPanel").addClass("active")});$("#personalPanel").find(".btn-next").on("click",()=>{var n=!0,t="",i={MemberNameCT:$("#MemberNameCT").val(),MemberMobileCT:$("#MemberMobileCT").val(),ContactAddressCT:$("#ContactAddressCT").val(),eMailCT:$("#eMailCT").val()},r={MemberNameCT:"姓名必填！",MemberMobileCT:"手機必填！",ContactAddressCT:"地址必填！",eMailCT:"eMailo必填！"};if($.each(i,function(i,u){(u===""||u===null)&&(n=!1,t+=r[i]+"\r\n")}),checkMobil($("#MemberMobileCT").val())||(n=!1,t+="手機格式不正確！\r\n"),checkeMail($("#eMailCT").val())||(n=!1,t+="eMail格式不正確！\r\n"),!n){alert(t);return}contactData=new ContactData($("#MemberNameCT").val(),$("#MemberMobileCT").val(),$("#PhoneCT").val(),$("#ContactAddressCT").val(),$("#eMailCT").val(),$("#FreightCT").val());$(".flowpath-item").removeClass("active");$("#paywayFlow").addClass("active");$("#personalPanel").removeClass("active");$("#paywayPanel").addClass("active");green=[];$.ajax({type:"Post",cache:!1,url:ni,data:{MemberMobile:jMemberMobile,Carts:carts,ContactData:contactData,CartTobal:cartTobal}}).done(n=>{$("#paywayPanel").html(n),window.scrollTo(0,0)}).fail(pi)})},ir=n=>{$("#mainContent").empty();$("#mainContent").html(n);$(document).on("click","#mobileSide",()=>{$("#memberMenu").addClass("active")});$("#btnMenuClose").on("click",()=>{$("#memberMenu").removeClass("active")})},wi=n=>{$("#memberPanel").empty();$("#memberPanel").html(n);$(document).on("click","#mobileSide",()=>{$("#memberMenu").addClass("active")});$("#btnMenuClose").on("click",()=>{$("#memberMenu").removeClass("active")});$("#Birthday").datetimepicker(opt1);$("#sDateO").datetimepicker(opt1);$("#eDateO").datetimepicker(opt1)},gi=n=>{$("#mainContent").empty();$("#mainContent").html(n);$("#Birthday").datetimepicker(opt1);$(".header-box").find(".navbar-toggler").addClass("collapsed");$("#menuNavbar").removeClass("show");$(document).on("click","#mobileSide",()=>{$("#helpMenu").addClass("active")});$("#btnMenuClose").on("click",()=>{$("#helpMenu").removeClass("active")})},di=n=>{$("#helpPanel").empty();$("#helpPanel").html(n);$(document).on("click","#mobileSide",()=>{$("#helpMenu").addClass("active")});$("#btnMenuClose").on("click",()=>{$("#helpMenu").removeClass("active")})};$("#btnLogin").on("click",()=>{$.ajax({type:"GET",cache:!1,dataType:"HTML",url:i}).done(sr).fail(pi)});$("#navMenu").find(".nav-link").on("click",i=>{const e=$(i.currentTarget).data("nav");$("#navMenu").find(".nav-link").removeClass("active");$("#menuNavbar").removeClass("show");switch(e){case"home":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:r}).done(er).fail(pi);$(i.currentTarget).addClass("active");break;case"mall":$.ajax({type:"GET",cache:!1,dataType:"HTML",data:{MemberLevelId:jMemberlevelId},url:n}).done(or).fail(pi);$(i.currentTarget).addClass("active");break;case"cart":$.ajax({type:"POST",cache:!1,dataType:"HTML",url:t,data:{MemberMobile:jMemberMobile,Carts:carts}}).done(tr).fail(pi);$(i.currentTarget).addClass("active");break;case"member":jMemberMobile!=""?($.ajax({type:"GET",cache:!1,dataType:"HTML",url:u}).done(ir).fail(pi),$(i.currentTarget).addClass("active")):alert("請先登入！");break;case"joinus":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:f}).done(gi).fail(pi);$(i.currentTarget).addClass("active")}});$(document).on("click","#memberMenu > .nav > .nav-item > .nav-link",n=>{const t=$(n.currentTarget).data("member");$("#memberMenu").find(".nav-link").removeClass("active");$(n.currentTarget).addClass("active");$("#memberMenu").removeClass("active");switch(t){case"mail":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:b,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"data":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:e,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"level":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:o}).done(wi).fail(pi);break;case"wholesale":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:s}).done(wi).fail(pi);break;case"ship":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:h,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"order":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:c,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"favorite":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:l,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"follower":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:a,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"triymph":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:v,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"point":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:y,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi);break;case"membermove":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:w}).done(wi).fail(pi);break;case"wishipool":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:p}).done(wi).fail(pi);break;default:$.ajax({type:"GET",cache:!1,dataType:"HTML",url:b,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi)}});$(document).on("click","#helpMenu > .nav > .nav-item > .nav-link",n=>{const t=$(n.currentTarget).data("help");$("#helpMenu").find(".nav-link").removeClass("active");$(n.currentTarget).addClass("active");$("#helpMenu").removeClass("active");switch(t){case"register":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:k}).done(di).fail(pi);break;case"shoppingflow":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:d}).done(di).fail(pi);break;case"payway":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:g}).done(di).fail(pi);break;case"qanda":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:nt}).done(di).fail(pi);break;case"shipdays":$.ajax({type:"GET",cache:!1,dataType:"HTML",url:tt}).done(di).fail(pi);break;default:$.ajax({type:"GET",cache:!1,dataType:"HTML",url:k}).done(di).fail(pi)}});fr=new Swiper(".swiper-container",{autoHeight:!0,slidesPerView:3,centeredSlides:!0,spaceBetween:30,loop:!0,autoplay:{delay:2500,disableOnInteraction:!1},pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});$("#linkJoinUs").on("click",()=>{$.ajax({type:"GET",cache:!1,dataType:"HTML",url:f}).done(gi).fail(pi),$("#navMenu").find(".nav-link").removeClass("active"),$("#navMenu").find('.nav-link[data-nav="joinus"]').addClass("active")});$("#productDetail").height(ur);$("#favoriteDetail").height(ur);$(document).on("click","#btnNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;jProductCategory=$("#spanProductCategory").text();$.ajax({type:"Post",cache:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,Product:jProduct,lowPrice:jlowPrice,jhightPrice:jhightPrice,Page:jCurrentPage,MemberLevelId:jMemberlevelId}}).done(ki).fail(pi)});$(document).on("click","#btnPrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;jProductCategory=$("#spanProductCategory").text();$.ajax({type:"Post",cache:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,Product:jProduct,lowPrice:jlowPrice,jhightPrice:jhightPrice,Page:jCurrentPage,MemberLevelId:jMemberlevelId}}).done(ki).fail(pi)});$(document).on("click","#PageList > .dropdown-item",n=>{n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jProductCategory=$("#spanProductCategory").text(),$.ajax({type:"Post",cache:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,Product:jProduct,lowPrice:jlowPrice,jhightPrice:jhightPrice,Page:jCurrentPage,MemberLevelId:jMemberlevelId}}).done(ki).fail(pi)});$(document).on("click","#btnSerachProduct",n=>{n.preventDefault(),jProduct=$("#Product").val(),jlowPrice=$("#lowPrice").val()===""||$("#lowPrice").val()===null?0:$("#lowPrice").val(),jhightPrice=$("#hightPrice").val()===""||$("#hightPrice").val()===null?1e6:$("#hightPrice").val(),jCurrentPage=1,jCurrentPage=$(n.currentTarget).data("page"),jProductCategory=$("#spanProductCategory").text(),$.ajax({type:"Post",cache:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,Product:jProduct,lowPrice:jlowPrice,hightPrice:jhightPrice,Page:jCurrentPage}}).done(ki).fail(pi)});const ki=n=>{$("#productPanel").html(n);jMemberlevelId!==2?($("#btnOfferProduct").hide(),$("#btnAllProduct").hide()):($("#btnOfferProduct").show(),$("#btnAllProduct").show());const t=$(".productlist-item .product-pic").width();$(".productlist-item .product-pic").height(t);$("#ProductLevelPath").removeClass("active")},nr=n=>{$("#ProductLevelPath").html(n),$.ajax({type:"Post",cache:!1,async:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,Product:jProduct,lowPrice:jlowPrice,hightPrice:jhightPrice,Page:jCurrentPage,MemberLevelId:jMemberlevelId}}).done(ki).fail(pi)};let cr=0,lr=200,rr=!1,bi;$(document).on("click","#ProductCategoryList > .nav > .nav-item > .nav-link",n=>{n.preventDefault(),bi=$(n.currentTarget),cr=setTimeout(function(){rr||(jProductCategoryId=bi.data("productcategoryid"),jProductCategory=bi.text(),$.ajax({type:"Post",cache:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,MemberLevelId:jMemberlevelId}}).done(ki).fail(pi));rr=!1},lr)}).on("dblclick","#ProductCategoryList > .nav > .nav-item > .nav-link",n=>{n.preventDefault(),bi=$(n.currentTarget),rr=!0,jProductCategoryId=bi.data("productcategoryid"),jProductCategory=bi.text(),jProduct="",jlowPrice=0,jhightPrice=1e6,jCurrentPage=1,$.ajax({type:"Post",cache:!1,async:!1,dataType:"HTML",url:ut,data:{ProductCategoryId:jProductCategoryId}}).done(nr).fail(pi)});$(document).on("click","#btnSubCategory",()=>{jProduct="",jlowPrice=0,jhightPrice=1e6,jCurrentPage=1,$.ajax({type:"Post",cache:!1,async:!1,dataType:"HTML",url:ut,data:{ProductCategoryId:jProductCategoryId}}).done(nr).fail(pi)});$(document).on("click","#btnSeatchProductCategory",n=>{if(n.preventDefault(),$("#ProductCategory").val()===""||$("#ProductCategory").val()===null){alert("請輸入分類名稱！");return}jProductCategory=$("#ProductCategory").val();$.ajax({type:"Post",cache:!1,url:ft,data:{ProductCategory:jProductCategory}}).done(ar).fail(pi)});const ar=n=>{if(n<=0){alert("查無此分類！");return}jProductCategoryId=n;jlowPrice=0;jhightPrice=1e6;jCurrentPage=1;$.ajax({type:"Post",cache:!1,async:!1,dataType:"HTML",url:ut,data:{ProductCategoryId:jProductCategoryId}}).done(nr).fail(pi)};$(document).on("click","#ProductCategoryLevel > .breadcrumb-item > .ProductLevelPathList",n=>{bi=$(n.currentTarget),n.preventDefault(),jProductCategoryId=bi.data("productcategoryid"),jProductCategory=bi.text(),jProduct="",jlowPrice=0,jhightPrice=1e6,jCurrentPage=1,$.ajax({type:"Post",cache:!1,async:!1,dataType:"HTML",url:ut,data:{ProductCategoryId:jProductCategoryId}}).done(nr).fail(pi)});$(document).on("click","#btnOfferProduct",n=>{n.preventDefault(),$.ajax({type:"Post",cache:!1,dataType:"HTML",url:ot}).done(ki).fail(pi)});$(document).on("click","#btnAllProduct",()=>{$.ajax({type:"Post",cache:!1,dataType:"HTML",url:rt,data:{ProductCategoryId:jProductCategoryId,ProductCategory:jProductCategory,MemberLevelId:jMemberlevelId}}).done(ki).fail(pi)});$(document).on("click","#btnJoinMember",()=>{var t=!0,n="",i={MemberMobile:$("#MemberMobile").val(),Password:$("#Password").val(),MemberName:$("#MemberName").val(),NickName:$("#NickName").val(),sex:$("#sex").val(),eMail:$("#eMail").val(),ContactAddress:$("#ContactAddress").val()},r={MemberMobile:"手機(帳號)必填！",Password:"密碼必填！",MemberName:"姓名必填！",NickName:"暱稱必填！",sex:"性別必填！",eMail:"eMail必填！",ContactAddress:"聯絡地址必填！"};if($.each(i,function(i,u){(u===""||u===null)&&(t=!1,n+=r[i]+"\r\n")}),$("#Password").val()!==$("#ConfirmPassword").val()&&(n+="確認密碼必須和密碼相同！\r\n"),!t){alert(n);return}if(t=!0,n="",checkMobil($("#MemberMobile").val())||(t=!1,n+="手機格式不正確！\r\n"),checkeMail($("#eMail").val())||(t=!1,n+="eMail格式不正確！\r\n"),!t){alert(n);return}$("#refbutton").click();$("#ref_confirm_button").on("click",function(){if($("#checkboxOK").prop("checked")==!1){alert('請勾選"已閱讀"');return}$("#modalOff").click();$.ajax({type:"Post",cache:!1,dataType:"json",url:st,data:{MemberMobile:$("#MemberMobile").val(),Password:$("#Password").val(),MemberName:$("#MemberName").val(),NickName:$("#NickName").val(),sex:$("#sex").val(),eMail:$("#eMail").val(),ContactAddress:$("#ContactAddress").val()}}).done(n=>{console.log(n),n.ret===0?(alert("加入成功！"),$("#exampleModalPhone").modal({backdrop:"static"})):n.ret===2?alert("手機(帳號) 重覆！"):n.ret===3?alert("暱稱 重覆！"):alert("執行失敗，請稍後再試！")}).fail(pi)})});$(document).on("click","#MemberVerification",()=>{function n(n){n===0&&(alert("驗證成功"),location.reload());n===-1?alert("系統錯誤"):"";n===-2?alert("驗證碼錯誤 !"):"";n===-3?alert("驗證碼逾期，請重新申請 !"):"";n===-4?alert("已驗證過，請直接登入 !"):""}$.ajax({type:"Post",cache:!1,dataType:"json",url:oi,data:{MemberMobile:$("#MemberMobile").val(),ValidateCode:$("#MobileVerification").val()}}).done(n).fail(pi)});$(document).on("click","#btnLoginMember",()=>{function e(n){console.log(n);n.result===0?(jMemberMobile=n.memberoobile,jMemberlevelId=n.memberlevelId,jNickName=n.nickName,$("#nickname").text(jNickName),$("#btnLogin").hide(),$("#e-b").hide(),$("#btnRegister").hide(),$("#btnLogout").show(),$("#c-b").attr("style","display:block"),$("#d-b").attr("style","display:block"),n.mailCount!=0?$("#MailCenterUnReadCount").text(n.mailCount):"",$(".footer-box").find(".nav-link").eq(1).css("display","block"),$(".footer-box").find(".nav-link").eq(5).css("display","block"),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:u}).done(ir).fail(pi),$("#navMenu").find(".nav-link").removeClass("active"),$("#MemberCenter").addClass("active")):n.result===2?alert("帳號錯誤！"):n.result===3?alert("密碼錯誤！"):n.result===4?alert("停權中！"):n.result===5?alert(`請勾選 "我不是機器人" ！`):n.result===6?alert("尚未取得手機認證 ！"):alert("執行失敗，請再試一次！")}var t=!0,n="",i={MemberMobileLogin:$("#MemberMobileLogin").val(),MemberPasswordLogin:$("#MemberPasswordLogin").val()},r={MemberMobileLogin:"帳號(手機)必填！",MemberPasswordLogin:"密碼必填！"},f;if($.each(i,function(i,u){(u===""||u===null)&&(t=!1,n+=r[i]+"\r\n")}),$("#Password").val()!==$("#ConfirmPassword").val()&&(n+="確認密碼必須和密碼相同！\r\n"),!t){alert(n);return}f=grecaptcha.getResponse();$("#Memberlogin").ajaxSubmit({dataType:"json",success:e,error:pi})});$(document).on("click","#btnUpdateMember",()=>{var n=!0,t="",i={MemberMobile:$("#MemberMobile").val(),Password:$("#Password").val(),MemberName:$("#MemberName").val(),NickName:$("#NickName").val(),sex:$("#sex").val(),eMail:$("#eMail").val(),ContactAddress:$("#ContactAddress").val()},r={MemberMobile:"手機(帳號)必填！",Password:"密碼必填！",MemberName:"姓名必填！",NickName:"暱稱必填！",sex:"性別必填！",eMail:"eMail必填！",ContactAddress:"聯絡地址必填！"};if($.each(i,function(i,u){(u===""||u===null)&&(n=!1,t+=r[i]+"\r\n")}),!n){alert(t);return}if(n=!0,t="",checkMobil($("#MemberMobile").val())||(n=!1,t+="手機格式不正確！\r\n"),checkeMail($("#eMail").val())||(n=!1,t+="eMail格式不正確！\r\n"),!n){alert(t);return}$.ajax({type:"Post",cache:!1,url:ct,data:{MemberMobile:$("#MemberMobile").val(),MemberName:$("#MemberName").val(),NickName:$("#NickName").val(),sex:$("#sex").val(),Birthday:$("#Birthday").val(),eMail:$("#eMail").val(),LineId:$("#LineId").val(),Phone:$("#Phone").val(),ContactAddress:$("#ContactAddress").val()}}).done(n=>{n===0?alert("更新 成功！"):n===3?alert("暱稱 重覆！"):alert("執行失敗，請稍後再試！")}).fail(pi)});$(document).on("click","#btnUpgradeMemberLevel",n=>{if(n.preventDefault(),$("#ReferrerMobile").val()!==""&&$("#ReferrerMobile").val()!==null||confirm("推薦人手機(帳號)未填，你將成為公司直屬會員，確定嗎？")){var t=!0,i="",r={ID:$("#ID").val(),Bank:$("#Bank").val(),Branch:$("#Branch").val(),AccountNunber:$("#AccountNunber").val(),AccountName:$("#AccountName").val()},u={ID:"身份證/統一編號必填！",Bank:"銀行必填！",Branch:"分行必填！",AccountNunber:"帳號必填！",AccountName:"帳戶名稱必填！"};if($.each(r,function(n,r){(r===""||r===null)&&(t=!1,i+=u[n]+"\r\n")}),!t){alert(i);return}if(t=!0,i="",$("#ReferrerMobile").val()!=null&&$("#ReferrerMobile").val()!=""&&(checkMobil($("#ReferrerMobile").val())||(t=!1,i+="推薦手機格式不正確！\r\n")),checkID($("#ID").val())||(t=!1,i+="身份證字號格式不正確！\r\n"),checkBankAccount($("#AccountNunber").val())||(alert($("#AccountNunber").val()),t=!1,i+="銀行帳號格式不正確！\r\n"),!t){alert(i);return}if($("#UpImgExample").val()==""||$("#UpImgExample").val()==null){alert("請上傳資料照片");return}$("#refbutton").click();$("#ref_confirm_button").on("click",function(){function n(n){n===0?(alert("申請升級批發會員成功，你目前為準批發會員！"),$("#MemberLevel").val("準批發會員"),$("#btnUpgradeMemberLevel").hide()):n===2?alert("推薦人非本公司員工或本平台之批發會員！"):alert("執行失敗，請稍後再試！")}if($("#checkboxOK").prop("checked")==!1){alert('請勾選"已閱讀"');return}$("#modalOff").click();$("#CreateForm").ajaxSubmit({dataType:"json",success:n,error:pi})})}});$(document).on("click",".productlist-item .btn-favorite, #divmyfavorite .btn-favorite",n=>{if(n.preventDefault(),jMemberMobile===null||jMemberMobile===""){alert("請先登入！");return}confirm("確定加入我的最愛嗎？")&&$.ajax({type:"POST",cache:!1,url:at,data:{ProductId:$(n.currentTarget).data("productid"),MemberMobile:jMemberMobile}}).done(n=>{n===0?alert("加入我的最愛成功！"):n===2?alert("產品先前己加入！"):alert("執行失敗，請稍後再試！")}).fail(pi)});$(document).on("change","#sizeD, #colorD",n=>{n.preventDefault(),$.ajax({type:"Get",cache:!1,url:vt,data:{ProductId:jProductId,SizeId:$("#sizeD option:selected").val(),ColorId:$("#colorD option:selected").val()}}).done(n=>{jQuantity=n,$("#lblQuantityD").text("數量("+n+")")}).fail(pi)});$(document).on("click","#btnAddQuantity",n=>{n.preventDefault();var i=!0,r="",e={Quantity:$("#quantityD").val(),SizeId:$("#sizeD option:selected").val(),ColorId:$("#colorD option:selected").val()},o={Quantity:"數量必填！",SizeId:"尺寸必填！",ColorId:"顏色必填！"};if($.each(e,function(n,t){(t===""||t===null)&&(i=!1,r+=o[n]+"\r\n")}),$("#quantityD").val()>jQuantity&&(i=!1,r+="庫存不足！"),!i){alert(r);return}let u=!1;if(carts.forEach(function(n){n.sizeId==$("#sizeD option:selected").val()&&n.colorId==$("#colorD option:selected").val()&&(alert($("#sizeD option:selected").text()+"/"+$("#colorD option:selected").text()+" 己加入購物清單！"),u=!0)}),!u){if(parseInt($("#quantityD").val())<=0){alert("請輸入正確的購買數量 !");return}if(confirm("確定加入購物車嗎？")){let t='<div class="choose-item row"><div class="border border-dark col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 d-flex align-items-center pt-1 pb-1">';t+=$("#sizeD option:selected").text()+"<\/div>";t+='<div class="border border-dark col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 d-flex align-items-center pt-1 pb-1">';t+=$("#colorD option:selected").text()+"<\/div>";t+='<div class="border border-dark col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 d-flex align-items-center pt-1 pb-1">';t+=$("#quantityD").val()+"<\/div>";t+='<div class="border border-dark col-3 col-sm-3 col-md-3 col-lg-3 col-xl-3 d-flex align-items-center pt-1 pb-1">';t+='<button type="button" class="btn btn-secondary btn-favorite btn-deletecart" data-sizeid="'+$("#sizeD option:selected").val()+'" data-colorid="'+$("#colorD option:selected").val()+'">刪除<\/button>';t+="<\/div>";t+="<\/div>";$("#collapseChoose .card-body").append(t);let f=new cart(jProductId,$("#sizeD option:selected").val(),$("#colorD option:selected").val(),$("#quantityD").val(),$("#productD").text(),$("#priceD").text(),$("#sizeD option:selected").text(),$("#colorD option:selected").text());carts.push(f);console.log(f);jQuantity-=parseInt($("#quantityD").val());$("#lblQuantityD").text("數量("+jQuantity+")");$.ajax({type:"POST",cache:!1,url:yt,data:{MemberMobile:jMemberMobile,ProductId:jProductId,Carts:carts}}).done(n=>{n===0?(alert("加入購物車成功！"),carts=[]):alert("執行失敗，請稍後再試！")}).fail(pi)}}});$(document).on("click","#divmyfavorite .btn-addcart",n=>{n.preventDefault(),$("#btnProductDetailClose").click(),$.ajax({type:"POST",cache:!1,dataType:"HTML",url:t,data:{MemberMobile:jMemberMobile}}).done(tr).fail(pi)});$(document).on("click","#collapseChoose > .card-body > .choose-item > .pb-1 > .btn-deletecart",function(n){if(n.preventDefault(),confirm("此項目將會自購物車永久刪除，確定嗎？")){let t=$(n.currentTarget).data("sizeid"),i=$(n.currentTarget).data("colorid"),r=!1,u=-1;carts.every(function(n,f){return n.sizeId==t&&n.colorId==i?(r=!0,u=f,!1):!0});r&&(carts.splice(u,1),$(n.currentTarget).closest("div.choose-item").remove());jQuantity+=parseInt($("#quantityD").val());$("#lblQuantityD").text("數量("+jQuantity+")");var f=parseInt($("#quantityD").val())*-1;let e=new cart(jProductId,t,$("#colorD option:selected").val(),f,$("#productD").text(),$("#priceD").text(),$("#sizeD option:selected").text(),$("#colorD option:selected").text());carts.push(e);$.ajax({type:"POST",cache:!1,async:!1,url:yt,data:{MemberMobile:jMemberMobile,ProductId:jProductId,Carts:carts}}).done(()=>{$(this).closest("div.choose-item").remove(),$.ajax({type:"POST",cache:!1,async:!1,url:yi,data:{MemberMobile:jMemberMobile,ProductId:jProductId,ProductSizeId:t,ProductColorId:i}}).done(n=>{if(carts=[],n.length===0)alert("該品項已從購物車中刪除 ! ");else{var t=`目前購物車中 :`+n[0].product+`
尺寸:`+n[0].productSize+`
顏色:`+n[0].productColor+`
數量為『`+n[0].quantity+`』個。`;alert(t)}}).find(pi)}).find(pi)}});$(document).on("click","#memberPanel .myfavorite-component .btn-favoritedetail",n=>{jProductId=$(n.currentTarget).data("productid"),$.ajax({type:"POST",cache:!1,dataType:"HTML",url:et,data:{ProductId:$(n.currentTarget).data("productid"),MemberLevelId:jMemberlevelId}}).done(vr).fail(pi)});const vr=n=>{$("#favoriteDetail").empty();$("#favoriteDetail").html(n);$("#favoriteDetail").addClass("active");$(document).on("click","#favoriteDetail .btn-close",()=>{$("#favoriteDetail").removeClass("active")})};$(document).on("click","#CartLists .btn-cart-delete",n=>{if(n.preventDefault(),confirm("此項目將會自購物車永久刪除，確定嗎？")){let t=$(n.currentTarget),i=parseInt($(n.currentTarget).closest("tr").find("td:eq(1)").text());jMemberMobile!==""?$.ajax({type:"Post",cache:!1,async:!1,url:wt,data:{MemberMobile:jMemberMobile,Cart:new cart($(n.currentTarget).data("productid"),$(n.currentTarget).data("producsizeid"),$(n.currentTarget).data("productcolorid"))}}).done(n=>{n===0?($("#cartTotals").text(parseInt($("#cartTotals").text())-parseInt(t.data("subtotal"))),t.closest("tbody").find("tr:eq("+(i-1)+")").remove(),$.ajax({type:"Get",cache:!1,url:dt,data:{CartTotals:parseInt($("#cartTotals").text())-parseInt($("#FreightValue").text())}}).done(n=>{let t=parseInt(n.freight.freightValue)-parseInt($("#FreightValue").text());$("#FreightValue").text(n.freight.freightValue);freight.freightValue=n.freight.freightValue;$("#cartTotals").text(parseInt($("#cartTotals").text())+t)}).fail(pi)):alert("執行失敗，請稍後再試！")}).fail(pi):(carts.splice(i,1),$("#cartTotals").text(parseInt($("#cartTotals").text())-parseInt(t.data("subtotal"))),t.closest("tbody").find("tr:eq("+(i-1)+")").remove(),$.ajax({type:"Get",cache:!1,url:dt,data:{CartTotals:parseInt($("#cartTotals").text())-parseInt($("#FreightValue").text())}}).done(n=>{let t=parseInt(n.freight.freightValue)-parseInt($("#FreightValue").text());$("#FreightValue").text(n.freight.freightValue);freight.freightValue=n.freight.freightValue;$("#cartTotals").text(parseInt($("#cartTotals").text())+t)}).fail(pi))}});$(document).on("click","#CheckAll",()=>{$("#CartLists input:checkbox").prop("checked",$("#CheckAll").prop("checked"))});$(document).on("click","#ClearCheckAll",()=>{if(confirm("所有勾選項目將會自購物車永久刪除，確定嗎？")){let n=[],t=[];if(jMemberMobile!=="")$("#CartLists input:checkbox").each(function(t,i){$(i).prop("checked")&&n.push(new cart($(i).data("productid"),$(i).data("producsizeid"),$(i).data("productcolorid")))}),$.ajax({type:"Post",cache:!1,async:!1,url:bt,data:{MemberMobile:jMemberMobile,Carts:n}}).done(n=>{if(n===0){let n=0;$("#CartLists input:checkbox").each(function(t,i){$(i).prop("checked")&&($("#CartLists").find("tr:eq("+(t-n)+")").remove(),$("#cartTotals").text(parseInt($("#cartTotals").text())-parseInt($(i).data("subtotal"))),n+=1)});$.ajax({type:"Get",cache:!1,url:dt,data:{CartTotals:parseInt($("#cartTotals").text())-parseInt($("#FreightValue").text())}}).done(n=>{let t=parseInt(n.freight.freightValue)-parseInt($("#FreightValue").text());$("#FreightValue").text(n.freight.freightValue);freight.freightValue=n.freight.freightValue;$("#cartTotals").text(parseInt($("#cartTotals").text())+t)}).fail(pi)}else alert("執行失敗，請稍後再試！")}).fail(pi);else{let n=0;$("#CartLists input:checkbox").each(function(i,r){$(r).prop("checked")&&(t.push(i-n),$("#CartLists").find("tr:eq("+(i-n)+")").remove(),$("#cartTotals").text(parseInt($("#cartTotals").text())-parseInt($(r).data("subtotal"))),n+=1)});n=0;t.forEach(function(n){carts.splice(n,1)});$.ajax({type:"Get",cache:!1,url:dt,data:{CartTotals:parseInt($("#cartTotals").text())-parseInt($("#FreightValue").text())}}).done(n=>{let t=parseInt(n.freight.freightValue)-parseInt($("#FreightValue").text());$("#FreightValue").text(n.freight.freightValue);freight.freightValue=n.freight.freightValue;$("#cartTotals").text(parseInt($("#cartTotals").text())+t)}).fail(pi)}}});$(document).on("click","#CartLists .btn-cart-update",n=>{if(n.preventDefault(),confirm("此項目將會自購物車永久更新，確定嗎？")){let i=$(n.currentTarget),t=parseInt($(n.currentTarget).closest("tr").find("td:eq(1)").text()),u=parseInt($(n.currentTarget).closest("tr").find("td:eq(3)").text()),f=$($(n.currentTarget).closest("tr").find("td:eq(4)")).find(".productsize").val(),e=$(n.currentTarget).closest("tr").find("td:eq(5)").find(".productcolor").val(),o=$($(n.currentTarget).closest("tr").find("td:eq(4)")).find(".productsize").text(),s=$(n.currentTarget).closest("tr").find("td:eq(5)").find(".productcolor").text(),r=parseInt($(n.currentTarget).closest("tr").find("td:eq(6)").find("input").val());if(jMemberMobile!=="")$.ajax({type:"Post",cache:!1,async:!1,url:kt,data:{MemberMobile:jMemberMobile,Cart:new cart($(n.currentTarget).data("productid"),$(n.currentTarget).data("producsizeid"),$(n.currentTarget).data("productcolorid")),ProducSizeIdN:f,ProductColorIdN:e,ProductSize:o,ProductColor:s,QuantityN:r}}).done(n=>{if(n===0){let t=parseInt(i.closest("tr").find("td:eq(7)").text()),n=u*r;i.closest("tr").find("td:eq(7)").text(n);$("#cartTotals").text(parseInt($("#cartTotals").text())+(n-t));$.ajax({type:"Get",cache:!1,url:dt,data:{CartTotals:parseInt($("#cartTotals").text())-parseInt($("#FreightValue").text())}}).done(n=>{let t=parseInt(n.freight.freightValue)-parseInt($("#FreightValue").text());$("#FreightValue").text(n.freight.freightValue);freight.freightValue=n.freight.freightValue;$("#cartTotals").text(parseInt($("#cartTotals").text())+t)}).fail(pi);alert("更新成功")}else n==2?alert("庫存不足"):n==3?alert("購物清單重覆！"):alert("執行失敗，請稍後再試！")}).fail(pi);else{carts[t-1].sizeId=f;carts[t-1].colorId=e;carts[t-1].size=o;carts[t-1].color=s;carts[t-1].quantity=r;let h=parseInt(i.closest("tr").find("td:eq(7)").text()),n=u*r;i.closest("tr").find("td:eq(7)").text(n);$("#cartTotals").text(parseInt($("#cartTotals").text())+(n-h));$.ajax({type:"Get",cache:!1,url:dt,data:{CartTotals:parseInt($("#cartTotals").text())-parseInt($("#FreightValue").text())}}).done(n=>{let t=parseInt(n.freight.freightValue)-parseInt($("#FreightValue").text());$("#FreightValue").text(n.freight.freightValue);freight.freightValue=n.freight.freightValue;$("#cartTotals").text(parseInt($("#cartTotals").text())+t)}).fail(pi)}}});$(document).on("click",".joinus-link",n=>{n.preventDefault(),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:f}).done(gi).fail(pi)});$(document).on("click","#btnRegister",n=>{$.ajax({type:"GET",cache:!1,dataType:"HTML",url:f}).done(gi).fail(pi),$(n.currentTarget).addClass("active")});$(document).on("click","#inlineCheckbox1",n=>{$(n.currentTarget).prop("checked")?($("#MemberNameCT").val($("#MemberNameC").val()),$("#MemberMobileCT").val($("#MemberMobileC").val()),$("#PhoneCT").val($("#PhoneC").val()),$("#ContactAddressCT").val($("#ContactAddressC").val()),$("#eMailCT").val($("#eMailC").val()),$.ajax({type:"Get",cache:!1,url:gt,data:{ContactAddress:$("#ContactAddressCT").val()}}).done(n=>{freight.TrueOutFreightValue=n==1?freight.OutFreightValue:0,$("#FreightCT").val(freight.TrueOutFreightValue+freight.FreightValue)}).fail(pi)):($("#MemberNameCT").val(""),$("#MemberMobileCT").val(""),$("#PhoneCT").val(""),$("#ContactAddressCT").val(""),$("#eMailCT").val(""))});$(document).on("blur","#ContactAddressCT",()=>{$.ajax({type:"Get",cache:!1,url:gt,data:{ContactAddress:$("#ContactAddressCT").val()}}).done(n=>{freight.TrueOutFreightValue=n==1?freight.OutFreightValue:0,$("#FreightCT").val(freight.TrueOutFreightValue+freight.FreightValue)}).fail(pi)});$(document).on("click","#MybtnNextPageO",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;$.ajax({type:"GET",cache:!1,dataType:"HTML",url:c,data:{MemberMobile:jMemberMobile,Product:jProduct,OrderId:jOrderId,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MybtnPrePageO",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;$.ajax({type:"GET",cache:!1,dataType:"HTML",url:c,data:{MemberMobile:jMemberMobile,Product:jProduct,OrderId:jOrderId,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#FPageListO > .dropdown-item",n=>{n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:c,data:{MemberMobile:jMemberMobile,Product:jProduct,OrderId:jOrderId,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#btnSearchMyOrder",n=>{n.preventDefault(),jOrderId=$("#OrderId").val(),jProduct=$("#ProductO").val(),jsDate=$("#sDateO").val(),jeDate=$("#eDateO").val(),jCurrentPage=1,$.ajax({type:"GET",cache:!1,dataType:"HTML",url:c,data:{MemberMobile:jMemberMobile,Product:jProduct,OrderId:jOrderId,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click",".UudateOrderState",n=>{(n.preventDefault(),confirm("確定己付款了嗎？"))&&(bi=$(n.currentTarget),$.ajax({type:"Post",cache:!1,url:ti,data:{MemberMobile:jMemberMobile,OrderId:$(n.currentTarget).closest(".ordelist-box").data("orderid")}}).done(n=>{n==0?(alert("通知成功！"),bi.closest(".ordelist-box").find(".OrderState").val("己付款(待確認)"),bi.fadeOut()):n==2?alert("訂單不存在！"):alert("通知失敗，請稍會兒再試！")}).fail(pi))});$(document).on("click","#btnSerrchMyFollower",n=>{n.preventDefault(),jCurrentPage=1,$.ajax({type:"GET",cache:!1,dataType:"HTML",url:a,data:{MemberMobile:jMemberMobile,sDate:$("#sDateO").val(),eDate:$("#eDateO").val(),ReferrerMobile:$("#MemberMobileWhere").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MyfollowerPrePageO",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;$.ajax({type:"GET",cache:!1,dataType:"HTML",url:a,data:{MemberMobile:jMemberMobile,sDate:$("#sDateO").val(),eDate:$("#eDateO").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MyfollowerNextPageO",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;$.ajax({type:"GET",cache:!1,dataType:"HTML",url:a,data:{MemberMobile:jMemberMobile,sDate:$("#sDateO").val(),eDate:$("#eDateO").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MFPageListO > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}$.ajax({type:"GET",cache:!1,dataType:"HTML",url:a,data:{MemberMobile:jMemberMobile,sDate:$("#sDateO").val(),eDate:$("#eDateO").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#btnSerrchFollowertriumph",n=>{if(n.preventDefault(),jCurrentPage=1,$("#sDateO").val()!="")var u=new Date,t=new Date($("#sDateO").val().substring(0,4),$("#sDateO").val().substring(5,7),0),i=$("#sDateO").val().substring(0,8)+"01 00:00:00",r=$("#sDateO").val().substring(0,8)+ +t.getDate(0)+" 23:59:59";$.ajax({type:"GET",cache:!1,dataType:"HTML",url:v,data:{MemberMobile:jMemberMobile,sDate:i,eDate:r,ReferrerMobile:$("#MemberMobileWhere").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#FollowertriumphPrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}if(jCurrentPage-=1,$("#sDateO").val()!="")var u=new Date,t=new Date($("#sDateO").val().substring(0,4),$("#sDateO").val().substring(5,7),0),i=$("#sDateO").val().substring(0,8)+"01 00:00:00",r=$("#sDateO").val().substring(0,8)+ +t.getDate(0)+" 23:59:59";$.ajax({type:"GET",cache:!1,dataType:"HTML",url:v,data:{MemberMobile:jMemberMobile,sDate:i,eDate:r,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#FollowertriumphNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}if(jCurrentPage+=1,console.log(jCurrentPage),$("#sDateO").val()!="")var u=new Date,t=new Date($("#sDateO").val().substring(0,4),$("#sDateO").val().substring(5,7),0),i=$("#sDateO").val().substring(0,8)+"01 00:00:00",r=$("#sDateO").val().substring(0,8)+ +t.getDate(0)+" 23:59:59";$.ajax({type:"GET",cache:!1,dataType:"HTML",url:v,data:{MemberMobile:jMemberMobile,sDate:i,eDate:r,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#FollowertriumphPageList > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}if($("#sDateO").val()!="")var u=new Date,t=new Date($("#sDateO").val().substring(0,4),$("#sDateO").val().substring(5,7),0),i=$("#sDateO").val().substring(0,8)+"01 00:00:00",r=$("#sDateO").val().substring(0,8)+ +t.getDate(0)+" 23:59:59";$.ajax({type:"GET",cache:!1,dataType:"HTML",url:v,data:{MemberMobile:jMemberMobile,sDate:i,eDate:r,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click",".btn-favoritedelete",function(n){(n.preventDefault(),ProductId=$(this).attr("data-productid"),confirm("確定刪除？"))&&($selecteditadmin=$(this).parent().parent().parent().parent().parent().parent(),$.ajax({type:"POST",cache:!1,url:ii,data:{jMemberMobile:jMemberMobile,ProductId:ProductId}}).done(yr).fail(pi))});$(document).on("click","#LostPassword",function(n){function i(n){n==0?alert("重設密碼信已寄出"):"";n==-1?alert("查無此帳號"):"";n==-2?alert("此帳號無設定信箱"):""}n.preventDefault();var t=$("#MemberMobileLogin").val();if(t==""||t==null){alert("請輸入帳號!!");return}confirm("確定申請重設定密碼？")&&$.ajax({type:"POST",cache:!1,url:fi,data:{MemberMobile:t}}).done(i).fail(pi)});$("#btnLogout").on("click",function(n){function t(n){if(n==0){if(!confirm("確定登出？"))return;jMemberMobile="";jMemberMobile=null;location.reload()}else alert("登出失敗！")}n.preventDefault();$.ajax({type:"Post",url:ri,success:t,error:pi})});$("#ChangePassword").on("click",function(n){function r(n){n==0?(alert("變更密碼成功 ! "),location.href=ui):n==-2&&alert("密碼已變更過，請重新申請 ! ")}if(n.preventDefault(),confirm("確定變更新設定密碼？")){var t=$("#MemberPassword").val(),i=$("#DoubleCheckPassword").val();if(t==""||i==""){alert("請輸入密碼!");return}if(t!=i){alert("密碼欄位不相同!");return}$.ajax({type:"POST",cache:!1,url:UpdateMemberPassword,data:{MemberMobile:sMemberMobile,MemberPassword:t,DoubleCheckPassword:i,token:sToken}}).done(r).fail(pi)}});$(document).on("click","#FinishCart",function(n){function t(n){$("#mainContent").empty();$("#mainContent").html(n)}(n.preventDefault(),confirm("確定完成訂單嗎？"))&&(console.log(contactData),console.log($(this).data("orderid")),console.log(jMemberMobile),$.ajax({type:"Post",cache:!1,dataType:"HTML",url:it,data:{ContactData:contactData,OrderId:$(this).data("orderid"),OrderStateId:1,MemberMobile:jMemberMobile}}).done(t).fail(pi))});$(document).on("click","#btnSerrchProductDetail",n=>{n.preventDefault(),jCurrentPage=1,jsDate=$("#sDateO").val(),jeDate=$("#eDateO").val(),console.log(jsDate,jsDate,jMemberMobile),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:y,data:{MemberMobile:jMemberMobile,sDate:jsDate,eDate:jeDate}}).done(wi).fail(pi)});$(document).on("click","#ProductDetailPrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;console.log(jCurrentPage);jsDate=$("#sDateO").val();jeDate=$("#eDateO").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:y,data:{MemberMobile:jMemberMobile,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#ProductDetailNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;console.log(jCurrentPage);jsDate=$("#sDateO").val();jeDate=$("#eDateO").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:y,data:{MemberMobile:jMemberMobile,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#ProductDetailPageList > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}console.log(jCurrentPage);jsDate=$("#sDateO").val();jeDate=$("#eDateO").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:y,data:{MemberMobile:jMemberMobile,sDate:jsDate,eDate:jeDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#btnSerrchMessageValue",n=>{n.preventDefault(),jCurrentPage=1,MessageValue=$("#MessageValue").val(),console.log(MessageValue),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:b,data:{MemberMobile:jMemberMobile,MessageValue:MessageValue}}).done(wi).fail(pi)});$(document).on("click","#MessageValuePrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;MessageValue=$("#MessageValue").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:b,data:{MemberMobile:jMemberMobile,MessageValue:MessageValue,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MessageValueNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;MessageValue=$("#MessageValue").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:b,data:{MemberMobile:jMemberMobile,MessageValue:MessageValue,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MessageValuePageList > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}MessageValue=$("#MessageValue").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:b,data:{MemberMobile:jMemberMobile,MessageValue:MessageValue,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#btnSerrchMemberAddress",n=>{n.preventDefault(),jCurrentPage=1,$.ajax({type:"GET",cache:!1,dataType:"HTML",url:h,data:{MemberMobile:jMemberMobile,MemberName:$("#SerrchMemberName").val(),Phone:$("#SerrchPhone").val(),DeliveryAddress:$("#SerrchDeliveryAddress").val()}}).done(wi).fail(pi)});$(document).on("click","#MemberAddressPrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;$.ajax({type:"GET",cache:!1,dataType:"HTML",url:h,data:{MemberMobile:jMemberMobile,MemberName:$("#SerrchMemberName").val(),Phone:$("#SerrchPhone").val(),DeliveryAddress:$("#SerrchDeliveryAddress").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MemberAddressNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;$.ajax({type:"GET",cache:!1,dataType:"HTML",url:h,data:{MemberMobile:jMemberMobile,MemberName:$("#SerrchMemberName").val(),Phone:$("#SerrchPhone").val(),DeliveryAddress:$("#SerrchDeliveryAddress").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MemberAddressPageList > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}$.ajax({type:"GET",cache:!1,dataType:"HTML",url:h,data:{MemberMobile:jMemberMobile,MemberName:$("#SerrchMemberName").val(),Phone:$("#SerrchPhone").val(),DeliveryAddress:$("#SerrchDeliveryAddress").val(),Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#addMemberDeliveryAddress",function(){event.preventDefault();$("#InsertMemberDeliveryAddress").append(`<div class="card text-white">
                    <div class="card-header">新增送貨地址</div>
                    <div class="card-body">
                        <div class="form-group row">
                            <label for="" class="col-form-label col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">姓名：</label>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8">
                                <input type="text" id='newMemberName'  class="form-control" id="" value="">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="" class="col-form-label col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">信箱：</label>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8">
                                <input type="text"  id='neweMail' class="form-control" id="" value="">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="" class="col-form-label col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">住家/公司電話：</label>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8">
                                <input type="text" id='newPhone'  class="form-control" id="" value="">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label for="" class="col-form-label col-12 col-sm-12 col-md-12 col-lg-4 col-xl-4">送貨地址：</label>
                            <div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8">
                                <input type="text" id='newDeliveryAddress'  class="form-control" id="" value="">
                            </div>
                        </div>
                    </div>
                    <div class="card-footer text-muted">
                        <button type="button" id='newMemberDeliveryAddress' class="btn btn-add btn-maintype">新增</button>
                    </div>
                </div>`);$("#MemberDeliveryAddressList").empty()});$(document).on("click","#newMemberDeliveryAddress",function(){function n(n){n==0?alert("新增成功 !"):"";n==-1?alert("執行錯誤，請稍後再試！"):""}event.preventDefault();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:hi,data:{MemberMobile:jMemberMobile,MemberName:$("#newMemberName").val(),Phone:$("#newPhone").val(),DeliveryAddress:$("#newDeliveryAddress").val(),eMail:$("#neweMail").val()}}).done(n).fail(pi)});$(document).on("click","#UpdateMemberDeliveryAddress",function(){event.preventDefault();MemberAddressId=$(this).data("memberaddressid");MemberNameN=$(this).parents().parents().children().children().eq(0).children().eq(1).children().val();PhoneN=$(this).parents().parents().children().children().eq(2).children().eq(1).children().val();eMailN=$(this).parents().parents().children().children().eq(1).children().eq(1).children().val();DeliveryAddressN=$(this).parents().parents().children().children().eq(3).children().eq(1).children().val();console.log(MemberAddressId);console.log(MemberNameN);console.log(PhoneN);console.log(DeliveryAddressN);console.log(eMailN);$.ajax({type:"GET",cache:!1,dataType:"HTML",url:ci,data:{MemberMobile:jMemberMobile,MemberAddressId:MemberAddressId,MemberNameN:MemberNameN,PhoneN:PhoneN,DeliveryAddressN:DeliveryAddressN,eMailN:eMailN}}).done(n=>{n==0&&(alert("送貨地址更新成功"),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:h,data:{MemberMobile:jMemberMobile}}).done(wi).fail(pi)),n==-1?alert("系統錯誤，請稍後再試！"):"",n==-2?alert("資料重複，請重新修改！"):""}).fail(pi)});$(document).on("change","#CartShipaddress",function(){$.ajax({type:"GET",cache:!1,dataType:"json",url:li,data:{MemberMobile:jMemberMobile,MemberAddressId:this.value}}).done(n=>{$("#MemberNameCT").val(n[0].memberName),$("#MemberMobileCT").val(n[0].memberMobile),$("#PhoneCT").val(n[0].phone),$("#ContactAddressCT").val(n[0].deliveryAddress),$("#eMailCT").val(n[0].eMail)}).fail(pi)});$(document).on("click","#btnSerrchMembermove",n=>{n.preventDefault(),jCurrentPage=1,sDate=$("#sDateO").val(),eDate=$("#eDateO").val(),MessageValue=$("#MessageValue").val(),NickName=$("#NickName").val(),console.log(sDate),console.log(eDate),console.log(MessageValue),console.log(NickName),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:w,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate}}).done(wi).fail(pi)});$(document).on("click","#MembermovePrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;sDate=$("#sDateO").val();eDate=$("#eDateO").val();MessageValue=$("#MessageValue").val();NickName=$("#NickName").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:w,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MembermoveNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;sDate=$("#sDateO").val();eDate=$("#eDateO").val();MessageValue=$("#MessageValue").val();NickName=$("#NickName").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:w,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MembermovePageList > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}sDate=$("#sDateO").val();eDate=$("#eDateO").val();MessageValue=$("#MessageValue").val();NickName=$("#NickName").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:w,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#btn-NewMembermove",function(){event.preventDefault();VersionId=parseInt($(this).data("versionid"));MessageTitle=$("#newMembermoveMessageTitle").val();MessageValue=$("#newMembermoveMessageValue").val();MemberMobile=jMemberMobile;$.ajax({type:"GET",cache:!1,dataType:"json",url:ai,data:{VersionId:VersionId,MessageTitle:MessageTitle,MessageValue:MessageValue,MemberMobile:MemberMobile}}).done(n=>{n==0&&(alert("留言新增成功 !"),$("#newModal").modal("hide")),n==-3?alert("系統錯誤，請稍後再試！"):"",n==-1?alert("新增失敗，請稍後再試！"):""}).fail(pi)});$(document).on("click",".newReplyModal",function(){event.preventDefault();$("#ReplyVersionid").val($(this).data("messageid"));$("#newReplyModal").modal({backdrop:"static"})});$(document).on("click","#btn-NewReplyMessage",function(){event.preventDefault();$.ajax({type:"GET",cache:!1,dataType:"json",url:vi,data:{MessageId:$("#ReplyVersionid").val(),ReplyMessageValue:$("#newReplyMessageValue").val(),ReplyMobile:jMemberMobile}}).done(n=>{console.log(n),n==0&&(alert("回復成功 !"),$("#newReplyModal").modal("hide")),n==-1?alert("新增失敗，請稍後再試！"):"",n==-2?alert("重複留言，請5分鐘後再試！"):"",n==-3?alert("系統錯誤，請稍後再試！"):""}).fail(pi)});$(document).on("click","#btnSerrchWishipool",n=>{n.preventDefault(),jCurrentPage=1,sDate=$("#sDateO").val(),eDate=$("#eDateO").val(),MessageValue=$("#MessageValue").val(),NickName=$("#NickName").val(),console.log(sDate),console.log(eDate),console.log(MessageValue),console.log(NickName),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:p,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate}}).done(wi).fail(pi)});$(document).on("click","#WishipoolPrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;sDate=$("#sDateO").val();eDate=$("#eDateO").val();MessageValue=$("#MessageValue").val();NickName=$("#NickName").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:p,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#WishipoolNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;sDate=$("#sDateO").val();eDate=$("#eDateO").val();MessageValue=$("#MessageValue").val();NickName=$("#NickName").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:p,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#WishipoolPageList > .dropdown-item",n=>{if(n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jTotallPages==1){alert("己到第一頁");return}sDate=$("#sDateO").val();eDate=$("#eDateO").val();MessageValue=$("#MessageValue").val();NickName=$("#NickName").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:p,data:{MessageValue:MessageValue,NickName:NickName,sDate:sDate,eDate:eDate,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#btnSearchF",n=>{n.preventDefault(),jCurrentPage=1,$.ajax({type:"GET",cache:!1,dataType:"HTML",url:l,data:{MemberMobile:jMemberMobile,Product:$("#fProduct").val()}}).done(wi).fail(pi)});$(document).on("click","#MybtnNextPage",n=>{if(n.preventDefault(),jCurrentPage+1>jTotallPages){alert("己到最後一頁");return}jCurrentPage+=1;jProduct=$("#fProduct").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:l,data:{MemberMobile:jMemberMobile,Product:jProduct,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#MybtnPrePage",n=>{if(n.preventDefault(),jCurrentPage-1<1){alert("己到第一頁");return}jCurrentPage-=1;jProduct=$("#fProduct").val();$.ajax({type:"GET",cache:!1,dataType:"HTML",url:l,data:{MemberMobile:jMemberMobile,Product:jProduct,Page:jCurrentPage}}).done(wi).fail(pi)});$(document).on("click","#FPageList > .dropdown-item",n=>{n.preventDefault(),jCurrentPage=$(n.currentTarget).data("page"),jProduct=$("#fProduct").val(),$.ajax({type:"GET",cache:!1,dataType:"HTML",url:l,data:{MemberMobile:jMemberMobile,Product:jProduct,Page:jCurrentPage}}).done(wi).fail(pi)});$(".footer-box").find(".nav-link").on("click",n=>{n.preventDefault();const i=$(n.currentTarget).data("no");i===1&&$("#BrandStory").addClass("active");i===2&&$.ajax({type:"GET",cache:!1,dataType:"HTML",url:u}).done(ir).fail(pi);i===3&&$("#MemberLevel").addClass("active");i===4&&$("#QuestionAnswer").addClass("active");i===5&&$("#ShoppingProcess").addClass("active");i===6&&$.ajax({type:"POST",cache:!1,dataType:"HTML",url:t,data:{MemberMobile:jMemberMobile,Carts:carts}}).done(tr).fail(pi)});$(".btnFooterDetailClose").on("click",function(){var n="#"+$(this).closest("div").attr("id");$(n).removeClass("active")});$(document).on("click","#GetGoMember",function(){event.preventDefault();$.ajax({type:"Post",cache:!1,dataType:"HTML",url:u,data:{ContactData:contactData,OrderId:u,OrderStateId:1,MemberMobile:jMemberMobile}}).done(er).fail(pi)})}var jProductCategoryId,jProductCategory,jCurrentPage,jTotallPages,jProduct="",jlowPrice=0,jhightPrice=1e7,jMemberMobile="",jMemberlevelId=-1,jNickName,jProductId,jQuantity,jsDate="",jeDate="",carts=[],contactData,freight,cartTobal=0,orderId,jOrderId="",green=[];
