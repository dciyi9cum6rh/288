function Productfunction(n) { var t = { jProductCategoryId: 1, GetProductCategoryUrl: "", GetProductLevelPathUrl: "", DeleteProductCategoryUrl: "", GetProductListUrl: "", GetProductUrl: "", DeleteProductUrl: "", GetProductImageListUrl: "", DeleteProductImageUrl: "", SetProductImageUrl: "", jsDate: "", GetProductSizeUrl: "", DeleteProductSizeUrl: "", GetProductColorUrl: "", DeleteProductColorUrl: "", GetProductStockListUrl: "" }, o, r, s, h, c, a, v; t = $.extend(t, n); $(window).keydown(function (n) { if (n.keyCode === 13) return n.preventDefault(), !1 }); let u = t.jProductCategoryId, f; $(document).on("click", "#btnCategorySearch", function (n) { n.preventDefault(); f = $("#ProductCategory").val(); $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductCategoryUrl, data: { ProductCategoryId: u, ProductCategory: f }, beforeSend: LoadBefore, success: GetProductCategorySuccess, error: SystemError }) }); $(document).on("click", ".page-link", function (n) { n.preventDefault(); var r = $(this).attr("href").split("?"), i = r[1].split("&"), e = i[0].split("="), o = i[1].split("="), s = i[2].split("="); $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductCategoryUrl, data: { ProductCategoryId: u, ProductCategory: f, Page: parseInt(e[1]), LinkType: parseInt(o[1]), StartPage: parseInt(s[1]) }, beforeSend: LoadBefore, success: GetProductCategorySuccess, error: SystemError }) }); $(document).on("click", "a.ProductLevelPathList", function (n) { n.preventDefault(); u = $(this).attr("title"); f = ""; $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductCategoryUrl, data: { ProductCategoryId: u, ProductCategory: f }, beforeSend: LoadBefore, success: GetProductCategorySuccess, error: SystemError }); $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductLevelPathUrl, data: { ProductCategoryId: u }, beforeSend: LoadBefore, success: GetProductLevelPathSuccess, error: SystemError }) }); $("#btnAdd").on("click", function (n) { n.preventDefault(); $("#add-one input").val(""); $("#add-one textarea").val(""); $("#CreateForm").attr("Style", ""); $("#EditForm").attr("Style", "display: none;"); $("#add-one").modal({ backdrop: "static" }) }); $("#CreateSubmit").on("click", function (n) { function e() { } function s(n) { n == 0 ? alert("新增成功！") : n == 1 ? alert("無此權限！") : n == 2 ? alert("新增失敗,可能是商品分類名稱重覆！") : alert("執行失敗，請再試一次！") } n.preventDefault(); $(this).prop("disabled", !0); o = $(this); var t = !0, i = "", r = { ProductCategory: $("#ProductCategoryName").val(), ProductCategoryDescription: $("#ProductCategoryDescription").val(), PictureContent: $("#PictureContent").val() }, f = { ProductCategory: "商品分類名稱必填！", ProductCategoryDescription: "商品分類說明必填！", PictureContent: "分類圖示必填！" }; $.each(r, function (n, r) { (r == "" || r == null) && (t = !1, i += f[n] + "\r\n") }); t ? $("#CreateForm").ajaxSubmit({ data: { ParentProductCategoryId: u }, beforeSubmit: e, success: s, error: SystemError }) : alert(i); o.prop("disabled", !1) }); let i, e; $(document).on("click", ".btn-edit", function (n) { n.preventDefault(); i = $(this).closest("tr"); $("#add-one input").val(""); $("#add-one textarea").val(""); $("#EditProductCategoryName").val(i.find("td:eq(1)").text()); $("#EditProductCategoryDescription").val(i.find("td:eq(3)").text()); e = i.find("td:eq(0)").text(); $("#CreateForm").attr("Style", "display: none;"); $("#EditForm").attr("Style", ""); $("#add-one").modal({ backdrop: "static" }) }); $("#EditSubmit").on("click", function (n) { function f() { } function o(n) { n == 0 ? alert("修改成功！") : n == 1 ? alert("無此權限！") : n == 2 ? alert("新增失敗,可能是商品分類名稱重覆！") : alert("執行失敗，請再試一次！") } n.preventDefault(); $(this).prop("disabled", !0); s = $(this); var t = !0, i = "", r = { ProductCategory: $("#EditProductCategoryName").val(), ProductCategoryDescription: $("#EditProductCategoryDescription").val() }, u = { ProductCategory: "商品分類名稱必填！", ProductCategoryDescription: "商品分類說明必填！" }; $.each(r, function (n, r) { (r == "" || r == null) && (t = !1, i += u[n] + "\r\n") }); t ? $("#EditForm").ajaxSubmit({ data: { ProductCategoryId: e }, beforeSubmit: f, success: o, error: SystemError }) : alert(i); s.prop("disabled", !1) }); $(document).on("click", ".btn-delete", function () { function i() { } function u(n) { n == 0 ? (alert("刪除成功"), r.html("")) : n == 2 ? alert("無此權限！") : n == 3 ? alert("無法刪除有子分類之分類！") : n == 4 ? alert("無法刪除有商品之分類！") : alert("刪除失敗，請稍後再試！") } if (confirm("確定刪除？")) { var n = $(this); r = n.closest("tr"); e = r.find("td:eq(0)").text(); $.ajax({ type: "POST", cache: !1, url: t.DeleteProductCategoryUrl, data: { ProductCategoryId: e }, beforeSend: i, success: u, error: SystemError }) } }); $(document).on("click", ".btn-product", function (n) { n.preventDefault(); jProductCategoryProduct = $(this).closest("tr").find("td:eq(1)").text(); console.log(jProductCategoryProduct); $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductListUrl, data: { ProductCategory: jProductCategoryProduct, AClass: "pro-page-link" }, beforeSend: LoadBefore, success: GetProductListSuccess, error: SystemError }) }); $(document).on("click", "#btnSearch", function (n) { n.preventDefault(); jProductCategoryProduct = $("#ProductCategoryProduct").val(); jProduct = $("#Product").val(); $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductListUrl, data: { ProductCategory: jProductCategoryProduct, Product: jProduct, AClass: "pro-page-link" }, beforeSend: LoadBefore, success: GetProductListSuccess, error: SystemError }) }); $(document).on("click", ".pro-page-link", function (n) { n.preventDefault(); var r = $(this).attr("href").split("?"), i = r[1].split("&"), u = i[0].split("="), f = i[1].split("="), e = i[2].split("="); $.ajax({ type: "Post", cache: !1, dataType: "HTML", url: t.GetProductListUrl, data: { ProductCategory: jProductCategoryProduct, Product: jProduct, AClass: "pro-page-link", Page: parseInt(u[1]), LinkType: parseInt(f[1]), StartPage: parseInt(e[1]) }, beforeSend: LoadBefore, success: GetProductListSuccess, error: SystemError }) }); $(document).on("click", ".btn-addproduct", function (n) { n.preventDefault(); jProductCategoryProduct = $(this).closest("tr").find("td:eq(1)").text(); jProductCategoryIdProduct = $(this).closest("tr").find("td:eq(0)").text(); $("#add-oneSize input").val(""); $("#add-oneSize textarea").val(""); $("#add-oneSize select").html(""); $("#CreateFormP").attr("Style", ""); $("#EditFormP").attr("Style", "display: none;"); $("#add-oneSize").modal({ backdrop: "static" }); $("#ProductCategoryNameP").val(jProductCategoryProduct) }); $("#CreateSubmitP").on("click", function (n) { function f() { } function e(n) { n == 0 ? alert("新增成功！") : n == 1 ? alert("無此權限！") : n == 2 ? alert("新增失敗,可能是商品名稱重覆！") : alert("執行失敗，請再試一次！") } n.preventDefault(); $(this).prop("disabled", !0); h = $(this); var t = !0, i = "", r = { ProductName: $("#ProductName").val(), Price: $("#Price").val(), OfferPrice: $("#OfferPrice").val(), SaleLimitPrice: $("#SaleLimitPrice").val() }, u = { ProductName: "商品名稱必填！", Price: "定價說明必填！", OfferPrice:"零售價必填！",SaleLimitPrice:"銷售量批價必填！"};$.each(r,function(n,r){(r==""||r==null)&&(t=!1,i+=u[n]+"\r\n")});t?$("#CreateFormP").ajaxSubmit({data:{ProductCategoryId:jProductCategoryIdProduct},beforeSubmit:f,success:e,error:SystemError}):alert(i);h.prop("disabled",!1)});$(document).on("click",".btn-edit-product",function(n){function i(n){$("#EditFormP").attr("Style","");$("#CreateFormP").attr("Style","display: none;");$("#add-oneP").modal({backdrop:"static"});$("#EditProductCategoryNameP").val(n.product.productCategory);$("#EditProductName").val(n.product.product);$("#EditPrice").val(n.product.price);$("#EditOfferPrice").val(n.product.offerPrice);$("#EditSaleLimitPrice").val(n.product.saleLimitPrice);$("#EditProductDescription").val(n.product.productDescription)}n.preventDefault();jProductId=$(this).closest("tr").find("td:eq(1)").text();$("#add-oneP input").val("");$("#add-oneP textarea").val("");$("#add-oneP select").html("");$.ajax({type:"Post",cache:!1,dataType:"json",url:t.GetProductUrl,data:{ProductId:jProductId},beforeSend:LoadBefore,success:i,error:SystemError})});$("#EditSubmitP").on("click",function(n){function f(){}function e(n){n==0?alert("修改成功！"):n==1?alert("無此權限！"):n==2?alert("新增失敗,可能是商品名稱重覆！"):alert("執行失敗，請再試一次！")}n.preventDefault();$(this).prop("disabled",!0);c=$(this);var t=!0,i="",r={ProductName:$("#EditProductName").val(),Price:$("#EditPrice").val(),OfferPrice:$("#EditOfferPrice").val(),SaleLimitPrice:$("#EditSaleLimitPrice").val()},u={ProductName:"商品名稱必填！",Price:"定價說明必填！",OfferPrice:"零售價必填！",SaleLimitPrice:"銷售量批價必填！"};$.each(r,function(n,r){(r==""||r==null)&&(t=!1,i+=u[n]+"\r\n")});t?$("#EditFormP").ajaxSubmit({data:{ProductId:jProductId},beforeSubmit:f,success:e,error:SystemError}):alert(i);c.prop("disabled",!1)});let l;$(document).on("click",".btn-delete-product",function(){function i(){}function u(n){n==0?(alert("刪除成功"),r.html("")):n==2?alert("無此權限！"):alert("刪除失敗，請稍後再試！")}if(confirm("確定刪除？")){var n=$(this);r=n.closest("tr");l=r.find("td:eq(1)").text();$.ajax({type:"POST",cache:!1,url:t.DeleteProductUrl,data:{ProductId:l},beforeSend:i,success:u,error:SystemError})}});$(document).on("click",".btn-image-product",function(n){function u(){}function f(n){r.closest("tr").next().html('<td colspan="10">'+n+"<\/td>");r.find("span").attr("title","隠藏");r.find("span").first().removeClass();r.find("span").first().addClass("glyphicon glyphicon-minus")}n.preventDefault();var r=$(this);if(jProductId=r.closest("tr").find("td:eq(1)").text(),i=r.closest("tr"),r.find("span").first().hasClass("glyphicon-minus")){$(this).closest("tr").next().html("");r.find("span").attr("title","圖示");r.find("span").first().removeClass();r.find("span").first().addClass("glyphicon glyphicon-camera");return}$.ajax({type:"Post",cache:!1,dataType:"HTML",url:t.GetProductImageListUrl,data:{ProductId:jProductId,AClass:"inner-page-link"},beforeSend:u,success:f,error:SystemError})});$(document).on("click",".inner-page-link",function(n){function o(n){i.next().html('<td colspan="10">'+n+"<\/td>")}n.preventDefault();var s=$(this),r=$(this).attr("href").split("?"),t=r[1].split("&"),u=t[0].split("="),f=t[1].split("="),e=t[2].split("=");$.ajax({type:"Post",cache:!1,dataType:"HTML",url:r[0],data:{ProductId:jProductId,Page:parseInt(u[1]),LinkType:parseInt(f[1]),StartPage:parseInt(e[1]),AClass:"inner-page-link"},beforeSend:LoadBefore,success:o,error:SystemError})});$(document).on("click",".btn-addimage",function(n){n.preventDefault();jProductId=$(this).closest("tr").find("td:eq(1)").text();$("#add-oneI input").val("");$("#add-oneI textarea").val("");$("#CreateFormI").attr("Style","");$("#EditFormI").attr("Style","display: none;");$("#add-oneI").modal({backdrop:"static"})});$("#CreateSubmitI").on("click",function(n){function f(){}function e(n){n==0?alert("新增成功！"):n==1?alert("無此權限！"):alert("執行失敗，請再試一次！")}n.preventDefault();$(this).prop("disabled",!0);a=$(this);var t=!0,i="",r={PictureContent:$("#PictureContentI").val()},u={PictureContent:"商品圖示必填！"};$.each(r,function(n,r){(r==""||r==null)&&(t=!1,i+=u[n]+"\r\n")});t?$("#CreateFormI").ajaxSubmit({data:{ProductId:jProductId},beforeSubmit:f,success:e,error:SystemError}):alert(i);a.prop("disabled",!1)});$(document).on("click",".btn-edit-productimage",function(n){n.preventDefault();jProductId=$(this).closest("tr").data("productid");jProductImageId=$(this).closest("tr").data("productimageid");$("#add-oneI input").val("");$("#add-oneI textarea").val("");$("#EditFormI").attr("Style","");$("#CreateFormI").attr("Style","display: none;");$("#add-oneI").modal({backdrop:"static"})});$("#EditSubmitI").on("click",function(n){function f(){}function e(n){n==0?alert("修改成功！"):n==1?alert("無此權限！"):alert("執行失敗，請再試一次！")}n.preventDefault();$(this).prop("disabled",!0);$EditSubmitI=$(this);var t=!0,i="",r={PictureContent:$("#EditPictureContentI").val()},u={PictureContent:"商品圖示必填！"};$.each(r,function(n,r){(r==""||r==null)&&(t=!1,i+=u[n]+"\r\n")});t?$("#EditFormI").ajaxSubmit({data:{ProductId:jProductId,ProductImageId:jProductImageId},beforeSubmit:f,success:e,error:SystemError}):alert(i);$EditSubmitI.prop("disabled",!1)});$(document).on("click",".btn-delete-productimage",function(){function n(){}function i(n){n==0?(alert("刪除成功"),r.html("")):n==2?alert("無此權限！"):alert("刪除失敗，請稍後再試！")}if(confirm("確定刪除？")){var u=$(this);jProductId=$(this).closest("tr").data("productid");jProductImageId=$(this).closest("tr").data("productimageid");$.ajax({type:"POST",cache:!1,url:t.DeleteProductImageUrl,data:{ProductId:jProductId,ProductImageId:jProductImageId},beforeSend:n,success:i,error:SystemError})}});$(document).on("click",".btn-product-majorimage",function(){function n(){}function i(n){n==0?alert("設定成功"):n==2?alert("無此權限！"):alert("刪除失敗，請稍後再試！")}if(confirm("確定設定？")){var r=$(this);jProductId=$(this).closest("tr").data("productid");jProductImageId=$(this).closest("tr").data("productimageid");$.ajax({type:"POST",cache:!1,url:t.SetProductImageUrl,data:{ProductId:jProductId,ProductImageId:jProductImageId},beforeSend:n,success:i,error:SystemError})}});$(document).on("click",".btn-stock",function(n){n.preventDefault();jProducSizeId=$(this).data("productsizeid");jProductColorId=$(this).data("productcollorid");console.log(jProducSizeId);console.log(jProductColorId);$("#add-oneS input").val("");$("#ProductN").val(jProduct);$("#ProductSizeN").val($(this).closest("tr").find("td:eq(1)").text());$("#ProductColorN").val($(this).closest("tr").find("td:eq(2)").text());$("#StockConsolidationTime").val(t.jsDate);$("#Stock").val($(this).closest("tr").find("td:eq(3)").text());$("#add-oneS").modal({backdrop:"static"})});$("#CreateSubmitS").on("click",function(n){function f(){}function e(n){n==0?alert("盤整成功！"):n==2?alert("無此權限！"):alert("執行失敗，請再試一次！")}n.preventDefault();$(this).prop("disabled",!0);v=$(this);var t=!0,i="",r={Stock:$("#Stock").val(),StockConsolidatio:$("#StockConsolidatio").val(),Consolidation:$("#Consolidation").val()},u={Stock:"原庫存必填！",StockConsolidatio:"正確庫存必填！",Consolidation:"盤整量必填！"};$.each(r,function(n,r){(r==""||r==null)&&(t=!1,i+=u[n]+"\r\n")});t?$("#CreateFormS").ajaxSubmit({data:{ProductId:jProductId,ProducSizeId:jProducSizeId,ProductColorId:jProductColorId},beforeSubmit:f,success:e,error:SystemError}):alert(i);v.prop("disabled",!1)});$(document).on("click",".btn-size",function(n){function i(n){var t,i;$("#add-oneSize").modal({backdrop:"static"});t="";for(i in n.productSize)t+="<option>"+n.productSize[i].productSize+"<\/option>";$("#selSize").html(t)}n.preventDefault();jProductId=$(this).closest("tr").find("td:eq(1)").text();$("#add-oneSize input").val("");$("#add-oneSize textarea").val("");$("#add-oneSize select").html("");$.ajax({type:"Post",cache:!1,dataType:"json",url:t.GetProductSizeUrl,data:{ProductId:jProductId},beforeSend:LoadBefore,success:i,error:SystemError})});$(document).on("click",".btn-AddSize",function(){function f(n){n==0?$("#selSize").append("<option>"+$("#ProductSize").val()+"<\/option>"):n==2?alert("無此權限！"):n==3?alert("尺寸重覆！"):alert("執行失敗，請再試一次！");i.prop("disabled",!1)}var i=$(this);$(this).prop("disabled",!0);var n=!0,t="",r={ProductSize:$("#ProductSize").val()},u={ProductSize:"商品尺寸必填！"};$.each(r,function(i,r){(r==""||r==null)&&(n=!1,t+=u[i]+"\r\n")});n?$("#CreateFormSize").ajaxSubmit({data:{ProductId:jProductId},beforeSubmit:LoadBefore,success:f,error:SystemError}):alert(t)});$(document).on("click",".btn-DelSize",function(){function n(){}function i(n){if(n==0){alert("刪除成功");var t="";$("#selSize option").each(function(){$(this).val()!==$("#selSize").val()&&(t+="<option>"+$(this).val()+"<\/option>")});$("#selSize").html(t)}else n==2?alert("無此權限！"):n==3?alert("有庫存不能刪！"):alert("刪除失敗，請稍後再試！")}if(confirm("確定刪除？")){var r=$(this);$.ajax({type:"POST",cache:!1,url:t.DeleteProductSizeUrl,data:{ProductId:jProductId,ProductSize:$("#selSize option:selected").val()},beforeSend:n,success:i,error:SystemError})}});$(document).on("click",".btn-color",function(n){function i(n){var t,i;$("#add-oneColor").modal({backdrop:"static"});t="";for(i in n.productColor)t+="<option>"+n.productColor[i].productColor+"<\/option>";$("#selColor").html(t)}n.preventDefault();jProductId=$(this).closest("tr").find("td:eq(1)").text();$("#add-oneColor input").val("");$("#add-oneColor textarea").val("");$("#add-oneColor select").html("");$.ajax({type:"Post",cache:!1,dataType:"json",url:t.GetProductColorUrl,data:{ProductId:jProductId},beforeSend:LoadBefore,success:i,error:SystemError})});$(document).on("click",".btn-AddColor",function(){function f(n){n==0?$("#selColor").append("<option>"+$("#ProductColor").val()+"<\/option>"):n==2?alert("無此權限！"):n==3?alert("顏色重覆！"):alert("執行失敗，請再試一次！");i.prop("disabled",!1)}var i=$(this);$(this).prop("disabled",!0);var n=!0,t="",r={ProductColor:$("#ProductColor").val()},u={ProductColor:"商品顏色必填！"};$.each(r,function(i,r){(r==""||r==null)&&(n=!1,t+=u[i]+"\r\n")});n?$("#CreateFormColor").ajaxSubmit({data:{ProductId:jProductId},beforeSubmit:LoadBefore,success:f,error:SystemError}):alert(t)});$(document).on("click",".btn-DelColor",function(){function n(){}function i(n){if(n==0){alert("刪除成功");var t="";$("#selColor option").each(function(){$(this).val()!==$("#selColor").val()&&(t+="<option>"+$(this).val()+"<\/option>")});$("#selColor").html(t)}else n==2?alert("無此權限！"):n==3?alert("有庫存不能刪！"):alert("刪除失敗，請稍後再試！")}if(confirm("確定刪除？")){var r=$(this);$.ajax({type:"POST",cache:!1,url:t.DeleteProductColorUrl,data:{ProductId:jProductId,ProductColor:$("#selColor option:selected").val()},beforeSend:n,success:i,error:SystemError})}});$(document).on("click",".btn-stock-pro",function(n){function u(){}function f(n){r.closest("tr").next().html('<td colspan="10">'+n+"<\/td>");r.find("span").attr("title","隠藏");r.find("span").first().removeClass();r.find("span").first().addClass("glyphicon glyphicon-minus")}n.preventDefault();var r=$(this);if(jProductId=r.closest("tr").find("td:eq(1)").text(),jProduct=r.closest("tr").find("td:eq(2)").text(),i=r.closest("tr"),r.find("span").first().hasClass("glyphicon-minus")){$(this).closest("tr").next().html("");r.find("span").attr("title","庫存");r.find("span").first().removeClass();r.find("span").first().addClass("glyphicon glyphicon-asterisk");return}$.ajax({type:"Post",cache:!1,dataType:"HTML",url:t.GetProductStockListUrl,data:{ProductId:jProductId,AClass:"inner-page-link-stock"},beforeSend:u,success:f,error:SystemError})});$(document).on("click",".inner-page-link-stock",function(n){function o(n){i.next().html('<td colspan="10">'+n+"<\/td>")}n.preventDefault();var s=$(this),r=$(this).attr("href").split("?"),t=r[1].split("&"),u=t[0].split("="),f=t[1].split("="),e=t[2].split("=");$.ajax({type:"Post",cache:!1,dataType:"HTML",url:r[0],data:{ProductId:jProductId,Page:parseInt(u[1]),LinkType:parseInt(f[1]),StartPage:parseInt(e[1]),AClass:"inner-page-link-stock"},beforeSend:LoadBefore,success:o,error:SystemError})})}function GetProductCategorySuccess(n){$("Div#ProductCategory").html(n)}function GetProductLevelPathSuccess(n){$("Div#ProductLevelPath").html(n)}function GetProductListSuccess(n){$("Div#ProductList").html(n);$("#ProductCategoryProduct").val(jProductCategoryProduct)}function LoadBefore(){}function SystemError(){alert("系統錯誤，請稍後再試！")}let jProductCategoryProduct="",jProductCategoryIdProduct,jProduct="",jProductId,jProductImageId,jProducSizeId,jProductColorId;$("#StockConsolidatio").on("change",function(){$("#Consolidation").val($("#StockConsolidatio").val()-$("#Stock").val())});